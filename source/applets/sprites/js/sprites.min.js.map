{"version":3,"sources":["sprites.js"],"names":["image_list","document","getElementById","settings","submit_btn","dropbox","workplace","workplace_width","workplace_height","background_size","css_code","sprites_img","result_pop","workplace_ctx","getContext","sprites","handleFiles","files","callback","i","length","file","type","match","reader","FileReader","onload","e","console","log","FileReaderOnload","readAsDataURL","dt","dd","img_container","createElement","img","li","meta","metas","src","target","result","push","text","value","name","width","height","formateFileSize","total","getFileType","formatDate","lastModifiedDate","forEach","v","innerHTML","appendChild","classList","add","cloneNode","getFileName","allname","split","pop","join","drawSprites","padding","x","y","drawImage","generateCss","filename","class_name","cssText","background_size_num","checked","class_names","size","K","M","G","unit","Math","floor","ceil","sizes","addEventListener","remove","stopPropagation","preventDefault","style","display","dataTransfer","parseInt","data","toDataURL","querySelector","evt","createEvent","initEvent","download","href","dispatchEvent","types","image/gif","image/png","image/jpeg","date","fmt","o","M+","getMonth","d+","getDate","h+","getHours","m+","getMinutes","s+","getSeconds","k","test","replace","RegExp","$1","getFullYear","substr"],"mappings":"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","file":"sprites.min.js","sourcesContent":["var image_list = document.getElementById('image_list'),\r\n  settings = document.getElementById('settings'),\r\n  submit_btn = document.getElementById('submit_btn'),\r\n  dropbox = document.getElementById('dropbox'),\r\n  workplace = document.getElementById('workplace'),\r\n  workplace_width = 0,\r\n  workplace_height = 0,\r\n  background_size = document.getElementById('background_size'),\r\n  css_code = document.getElementById('css_code'),\r\n  sprites_img = document.getElementById('sprites_img'),\r\n  result_pop = document.getElementById('result_pop'),\r\n  workplace_ctx = workplace.getContext('2d'),\r\n  sprites = []\r\n\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n\r\n  document.addEventListener('dragenter', function () {\r\n    dropbox.classList.add('dragFile')\r\n  }, false)\r\n\r\n  document.addEventListener('dragleave', function () {\r\n    dropbox.classList.remove('dragFile')\r\n  }, false)\r\n\r\n  dropbox.addEventListener('dragenter', function () {\r\n    dropbox.classList.add('dragenter')\r\n  }, false)\r\n\r\n  dropbox.addEventListener('dragleave', function () {\r\n    dropbox.classList.remove('dragenter')\r\n  }, false)\r\n\r\n  dropbox.addEventListener('dragenter', function (e) {\r\n    e.stopPropagation()\r\n    e.preventDefault()\r\n  }, false)\r\n\r\n  dropbox.addEventListener('dragover', function (e) {\r\n    e.stopPropagation()\r\n    e.preventDefault()\r\n  }, false)\r\n\r\n  dropbox.addEventListener('drop', function (e) {\r\n    e.stopPropagation()\r\n    e.preventDefault()\r\n    console.log(e)\r\n    //dropbox.style.display = \"none\";\r\n    settings.style.display = 'block'\r\n\r\n    handleFiles(e.dataTransfer.files, function (li) {\r\n      image_list.appendChild(li)\r\n    })\r\n  }, false)\r\n\r\n  submit_btn.addEventListener('click', function () {\r\n    var type = document.getElementById('type').value,\r\n      padding = parseInt(document.getElementById('padding').value),\r\n      filename = document.getElementById('filename').value\r\n\r\n    console.log(sprites)\r\n    drawSprites(type, padding)\r\n    css_code.value = generateCss(type, filename)\r\n\r\n    var data = workplace.toDataURL()\r\n\r\n    sprites_img.querySelector('img').src = data\r\n    result_pop.style.display = 'block'\r\n    settings.style.display = 'none'\r\n    dropbox.style.display = 'none'\r\n    var evt = document.createEvent('HTMLEvents')\r\n    evt.initEvent('click', false, false)\r\n    sprites_img.download = filename\r\n    sprites_img.href = data\r\n    sprites_img.dispatchEvent(evt)\r\n  }, false)\r\n})\r\n\r\nfunction handleFiles (files, callback) {\r\n  for (var i = 0; i < files.length; i++) {\r\n    var file = files[i]\r\n    if (!file.type.match(/image*/)) {\r\n      continue\r\n    }\r\n\r\n    var reader = new FileReader()\r\n    reader.onload = (function (file) {\r\n      return function (e) {\r\n        console.log(file)\r\n        FileReaderOnload(e, file, callback)\r\n      }\r\n    }(file))\r\n\r\n    reader.readAsDataURL(file)\r\n  }\r\n}\r\n\r\nfunction FileReaderOnload (e, file, callback) {\r\n  var img_container = document.createElement('div'),\r\n    img = document.createElement('img'),\r\n    li = document.createElement('li'),\r\n    meta = document.createElement('dl'),\r\n    metas = [],\r\n    dt, dd\r\n\r\n  img.src = e.target.result\r\n  //img.file = file;\r\n\r\n  //console.log(e,file);\r\n  metas.push({\r\n    'text': '文件名称：',\r\n    'value': file.name\r\n  })\r\n\r\n  metas.push({\r\n    'text': '文件大小：',\r\n    'value': img.width + 'px X ' + img.height + 'px'\r\n  })\r\n\r\n  metas.push({\r\n    'text': '文件尺寸：',\r\n    'value': formateFileSize(e.total)\r\n  })\r\n\r\n  metas.push({\r\n    'text': '文件类型：',\r\n    'value': getFileType(file.type)\r\n  })\r\n\r\n  metas.push({\r\n    'text': '上次修改时间：',\r\n    'value': formatDate(file.lastModifiedDate, 'yyyy-MM-dd hh:mm:ss')\r\n  })\r\n\r\n  metas.forEach(function (v) {\r\n    dt = document.createElement('dt')\r\n    dd = document.createElement('dd')\r\n\r\n    dt.innerHTML = v.text\r\n    dd.innerHTML = v.value\r\n    meta.appendChild(dt)\r\n    meta.appendChild(dd)\r\n  })\r\n\r\n  img_container.classList.add('img_container')\r\n  img_container.appendChild(img)\r\n\r\n  li.appendChild(img_container)\r\n  li.appendChild(img_container.cloneNode(true))\r\n  //li.appendChild(meta);\r\n  callback(li, e, file)\r\n\r\n  sprites.push({ img: img, file: file })\r\n}\r\n\r\nfunction getFileName (allname) {\r\n  allname = allname.split('.')\r\n  allname.pop()\r\n  allname.join('.')\r\n  return allname\r\n}\r\n\r\nfunction drawSprites (type, padding) {\r\n  var i\r\n  workplace_width = 0\r\n  workplace_height = 0\r\n\r\n  if (type == 'v_l') {\r\n    for (i = 0; i < sprites.length; i++) {\r\n      if (workplace_width < sprites[i].img.width) {\r\n        workplace_width = sprites[i].img.width\r\n      }\r\n    }\r\n\r\n    for (i = 0; i < sprites.length; i++) {\r\n      sprites[i].x = 0\r\n      if (i == 0) {\r\n        sprites[i].y = workplace_height\r\n        workplace_height += sprites[i].img.height\r\n      } else {\r\n        sprites[i].y = workplace_height + padding\r\n        workplace_height += sprites[i].img.height + padding\r\n      }\r\n    }\r\n  } else if (type == 'v_r') {\r\n    for (i = 0; i < sprites.length; i++) {\r\n      if (workplace_width < sprites[i].img.width) {\r\n        workplace_width = sprites[i].img.width\r\n      }\r\n    }\r\n\r\n    for (i = 0; i < sprites.length; i++) {\r\n      sprites[i].x = workplace_width - sprites[i].img.width\r\n\r\n      if (i == 0) {\r\n        sprites[i].y = workplace_height\r\n        workplace_height += sprites[i].img.height\r\n      } else {\r\n        sprites[i].y = workplace_height + padding\r\n        workplace_height += sprites[i].img.height + padding\r\n      }\r\n\r\n    }\r\n  } else if (type == 'h_t') {\r\n    for (i = 0; i < sprites.length; i++) {\r\n      if (workplace_height < sprites[i].img.height) {\r\n        workplace_height = sprites[i].img.height\r\n      }\r\n    }\r\n\r\n    for (i = 0; i < sprites.length; i++) {\r\n      sprites[i].y = 0\r\n      if (i == 0) {\r\n        sprites[i].x = workplace_width\r\n        workplace_width += sprites[i].img.width\r\n      } else {\r\n        sprites[i].x = workplace_width + padding\r\n        workplace_width += sprites[i].img.width + padding\r\n      }\r\n\r\n    }\r\n  } else if (type == 'h_b') {\r\n    for (i = 0; i < sprites.length; i++) {\r\n      if (workplace_height < sprites[i].img.height) {\r\n        workplace_height = sprites[i].img.height\r\n      }\r\n    }\r\n\r\n    for (i = 0; i < sprites.length; i++) {\r\n      sprites[i].y = workplace_height - sprites[i].img.height\r\n      if (i == 0) {\r\n        sprites[i].x = workplace_width\r\n        workplace_width += sprites[i].img.width\r\n      } else {\r\n        sprites[i].x = workplace_width + padding\r\n        workplace_width += sprites[i].img.width + padding\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  workplace.width = workplace_width\r\n  workplace.height = workplace_height\r\n\r\n  for (i = 0; i < sprites.length; i++) {\r\n    workplace_ctx.drawImage(sprites[i].img, sprites[i].x, sprites[i].y, sprites[i].img.width, sprites[i].img.height)\r\n  }\r\n\r\n}\r\n\r\nfunction generateCss (type, filename) {\r\n  var cssText = '',\r\n    //            commonCssText,\r\n    background_size_num = background_size.checked ? 2 : 1,\r\n    class_names = [],\r\n    class_name, i\r\n\r\n  console.log(background_size.checked, background_size_num)\r\n\r\n  if (type == 'v_l') {\r\n    for (i = 0; i < sprites.length; i++) {\r\n      class_name = '.' + getFileName(sprites[i].file.name)\r\n      class_names.push(class_name)\r\n      cssText += class_name + '{background-position: 0 ' + (-sprites[i].y / background_size_num) + 'px; width: ' + (sprites[i].img.width / background_size_num) + 'px; height: ' + (sprites[i].img.height / background_size_num) + 'px;}\\n'\r\n    }\r\n  } else if (type == 'v_r') {\r\n    for (i = 0; i < sprites.length; i++) {\r\n      class_name = '.' + getFileName(sprites[i].file.name)\r\n      class_names.push(class_name)\r\n      cssText += class_name + '{background-position: 100% ' + (-sprites[i].y / background_size_num) + 'px; width: ' + (sprites[i].img.width / background_size_num) + 'px; height: ' + (sprites[i].img.height / background_size_num) + 'px;}\\n'\r\n    }\r\n  } else if (type == 'h_t') {\r\n    for (i = 0; i < sprites.length; i++) {\r\n      class_name = '.' + getFileName(sprites[i].file.name)\r\n      class_names.push(class_name)\r\n      cssText += class_name + '{background-position: ' + (-sprites[i].x / background_size_num) + 'px 0; width: ' + (sprites[i].img.width / background_size_num) + 'px; height: ' + (sprites[i].img.height / background_size_num) + 'px;}\\n'\r\n    }\r\n  } else if (type == 'h_b') {\r\n    for (i = 0; i < sprites.length; i++) {\r\n      class_name = '.' + getFileName(sprites[i].file.name)\r\n      class_names.push(class_name)\r\n      cssText += class_name + '{background-position: ' + (-sprites[i].x / background_size_num) + 'px 100%; width: ' + (sprites[i].img.width / background_size_num) + 'px; height: ' + (sprites[i].img.height / background_size_num) + 'px;}\\n'\r\n    }\r\n  }\r\n\r\n  //        commonCssText = class_names.join(\",\");\r\n  //        commonCssText += '{background:url(' + filename + ') no-repeat; ' + ((background_size_num != 1) ? 'background-size:' + (workplace_width / background_size_num) + 'px ' + (workplace_height / background_size_num) + 'px; ' : '') + 'display:inline-block}';\r\n\r\n  //        cssText = commonCssText + '\\n' + cssText;\r\n  return cssText\r\n}\r\n\r\nfunction formateFileSize (size) {\r\n  var unit = 1024,\r\n    K, M, G\r\n\r\n  //console.log(size);\r\n  G = Math.floor(size / unit / unit / unit)\r\n  size -= G * unit\r\n  M = Math.floor(size / unit / unit)\r\n  size -= M * unit\r\n  K = Math.ceil(size / unit)\r\n\r\n  var sizes = []\r\n  G > 0 && sizes.push(G + 'G')\r\n  M > 0 && sizes.push(M + 'M')\r\n  K > 0 && sizes.push(K + 'K')\r\n\r\n  //console.log(sizes,G,M,K);\r\n  return sizes.join('')\r\n}\r\n\r\nvar getFileType = (function () {\r\n  var types = {\r\n    'image/gif': 'GIF',\r\n    'image/png': 'PNG',\r\n    'image/jpeg': 'JPG'\r\n  }\r\n\r\n  return function (type) {\r\n    return types[type]\r\n  }\r\n})()\r\n\r\nfunction formatDate (date, fmt) {\r\n  var o = {\r\n    'M+': date.getMonth() + 1,\r\n    'd+': date.getDate(),\r\n    'h+': date.getHours(),\r\n    'm+': date.getMinutes(),\r\n    's+': date.getSeconds()\r\n  }\r\n\r\n  if (/(y+)/.test(fmt)) {\r\n    fmt = fmt.replace(RegExp.$1, (date.getFullYear() + '').substr(4 - RegExp.$1.length))\r\n  }\r\n  for (var k in o) {\r\n    if (new RegExp('(' + k + ')').test(fmt)) {\r\n      fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (('00' + o[k]).substr(('' + o[k]).length)))\r\n    }\r\n  }\r\n\r\n  return fmt\r\n}\r\n"]}